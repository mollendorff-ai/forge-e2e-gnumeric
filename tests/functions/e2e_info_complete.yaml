# E2E Information Function Complete Coverage
# v6.6.0 - All 13 information functions with comprehensive tests

_forge_version: "1.0.0"

assumptions:
  # ═══════════════════════════════════════════════════════════════════════════
  # ISEVEN / ISODD - Parity checks
  # ═══════════════════════════════════════════════════════════════════════════
  iseven_true:
    value: null
    formula: "=IF(ISEVEN(4), 1, 0)"        # Expected: 1
  iseven_false:
    value: null
    formula: "=IF(ISEVEN(5), 1, 0)"        # Expected: 0
  isodd_true:
    value: null
    formula: "=IF(ISODD(5), 1, 0)"         # Expected: 1
  isodd_false:
    value: null
    formula: "=IF(ISODD(4), 1, 0)"         # Expected: 0
  iseven_zero:
    value: null
    formula: "=IF(ISEVEN(0), 1, 0)"        # Expected: 1
  isodd_negative:
    value: null
    formula: "=IF(ISODD(-3), 1, 0)"        # Expected: 1

  # ═══════════════════════════════════════════════════════════════════════════
  # ISNUMBER / ISTEXT / ISLOGICAL
  # ═══════════════════════════════════════════════════════════════════════════
  isnumber_true:
    value: null
    formula: "=IF(ISNUMBER(123), 1, 0)"    # Expected: 1
  istext_true:
    value: null
    formula: "=IF(ISTEXT(\"abc\"), 1, 0)"  # Expected: 1
  islogical_true:
    value: null
    formula: "=IF(ISLOGICAL(TRUE()), 1, 0)"  # Expected: 1
  islogical_false_val:
    value: null
    formula: "=IF(ISLOGICAL(FALSE()), 1, 0)" # Expected: 1

  # ═══════════════════════════════════════════════════════════════════════════
  # ISBLANK - Empty check
  # ═══════════════════════════════════════════════════════════════════════════
  isblank_text:
    value: null
    formula: "=IF(ISBLANK(\"\"), 1, 0)"    # Expected: 1 or 0 depending on impl
  isblank_number:
    value: null
    formula: "=IF(ISBLANK(0), 1, 0)"       # Expected: 0

  # ═══════════════════════════════════════════════════════════════════════════
  # ISERROR / ISNA - Error checks
  # NOTE: Forge throws on errors rather than returning error values like Excel
  # Test error detection with safe expressions; 1/0 tests covered in unit tests
  # ═══════════════════════════════════════════════════════════════════════════
  iserror_valid_is_not_error:
    value: null
    formula: "=IF(ISERROR(1+1), 1, 0)"     # Expected: 0 (no error)
  iserror_number_is_not_error:
    value: null
    formula: "=IF(ISERROR(123), 1, 0)"     # Expected: 0 (no error)
  isna_number_is_not_na:
    value: null
    formula: "=IF(ISNA(5), 1, 0)"          # Expected: 0 (5 is not NA)
  isna_text_is_not_na:
    value: null
    formula: "=IF(ISNA(\"test\"), 1, 0)"   # Expected: 0 (text is not NA)
  # NOTE: ISERROR(1/0) and ISNA(NA()) require error value support - see unit tests

  # ═══════════════════════════════════════════════════════════════════════════
  # N - Convert to number
  # ═══════════════════════════════════════════════════════════════════════════
  n_true:
    value: null
    formula: "=N(TRUE())"                  # Expected: 1
  n_false:
    value: null
    formula: "=N(FALSE())"                 # Expected: 0
  n_number:
    value: null
    formula: "=N(42)"                      # Expected: 42

  # ═══════════════════════════════════════════════════════════════════════════
  # TYPE - Value type code
  # ═══════════════════════════════════════════════════════════════════════════
  type_number:
    value: null
    formula: "=TYPE(123)"                  # Expected: 1
  type_text:
    value: null
    formula: "=TYPE(\"abc\")"              # Expected: 2
  type_logical:
    value: null
    formula: "=TYPE(TRUE())"               # Expected: 4

  # ═══════════════════════════════════════════════════════════════════════════
  # ISREF - Reference check (context-dependent)
  # ═══════════════════════════════════════════════════════════════════════════
  isref_value:
    value: null
    formula: "=IF(ISREF(123), 1, 0)"       # Expected: 0 (literal is not a reference)
  isref_text:
    value: null
    formula: "=IF(ISREF(\"A1\"), 1, 0)"    # Expected: 0 (text is not a reference)
  # Note: Testing ISREF(A1) requires cell reference context which may not be available in all test environments

  # ═══════════════════════════════════════════════════════════════════════════
  # ISFORMULA - Formula check (context-dependent)
  # ═══════════════════════════════════════════════════════════════════════════
  isformula_value:
    value: null
    formula: "=IF(ISFORMULA(42), 1, 0)"    # Expected: 0 (literal value)
  isformula_text:
    value: null
    formula: "=IF(ISFORMULA(\"test\"), 1, 0)"  # Expected: 0 (text value)
  # Note: Testing ISFORMULA(A1) requires checking if cell A1 contains a formula, which is context-dependent

  # ═══════════════════════════════════════════════════════════════════════════
  # NA - Return #N/A error value
  # ═══════════════════════════════════════════════════════════════════════════
  na_detected_by_isna:
    value: null
    formula: "=IF(ISNA(NA()), 1, 0)"       # Expected: 1 (NA() is detected by ISNA)
  na_type_is_error:
    value: null
    formula: "=TYPE(NA())"                 # Expected: 16 (error type)
  na_not_a_number:
    value: null
    formula: "=IF(ISNUMBER(NA()), 1, 0)"   # Expected: 0 (NA is not a number)
